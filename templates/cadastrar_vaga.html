<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cadastrar Vaga - Relâmpago</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet"/>
  <style>
    .equal-height-col {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .equal-height-box {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .checkbox-container {
      flex: 1;
      overflow-y: auto;
    }
    .textarea-container {
      flex: 1;
      min-height: 200px;
    }
    .textarea-container textarea {
      height: 100%;
      min-height: 200px;
    }
  </style>
</head>
<body>
  {% include 'navbar.html' %}

  <div class="container mt-4">
    <h2 class="mb-4 text-center" style="color: var(--vinho-escuro);">Cadastrar Nova Vaga</h2>

    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <form method="POST" action="{{ url_for('cadastrar_vaga') }}" enctype="multipart/form-data">
          <fieldset class="mb-4">
            <legend class="form-section-title">Dados Pessoais</legend>
            <div class="row">
              <div class="col-md-8 mb-3">
                <label for="nome_completo" class="form-label">Nome Completo</label>
                <input type="text" class="form-control" id="nome_completo" name="nome_completo" required>
              </div>
              <div class="col-md-4 mb-3">
                <label for="data_nascimento" class="form-label">Data de Nascimento</label>
                <input type="date" class="form-control" id="data_nascimento" name="data_nascimento" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="cpf" class="form-label">CPF</label>
                <input type="text" class="form-control" id="cpf" name="cpf" required>
              </div>
              <div class="col-md-6 mb-3">
                  <label for="estado_civil" class="form-label">Estado Civil</label>
                  <select class="form-select" id="estado_civil" name="estado_civil">
                      <option value="" selected disabled>Selecione...</option>
                      <option value="solteiro">Solteiro(a)</option>
                      <option value="casado">Casado(a)</option>
                      <option value="divorciado">Divorciado(a)</option>
                      <option value="viuvo">Viúvo(a)</option>
                      <option value="separado">Separado(a)</option>
                      <option value="uniao_estavel">União Estável</option>
                  </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="dependentes" class="form-label">Dependentes</label>
                <input type="number" class="form-control" id="dependentes" name="dependentes">
              </div>
            </div>
          </fieldset>

          <fieldset class="mb-4">
              <legend class="form-section-title">Contato</legend>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="telefone" class="form-label">Telefone</label>
                      <input type="tel" class="form-control" id="telefone" name="telefone">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="email" class="form-label">E-mail</label>
                      <input type="email" class="form-control" id="email" name="email">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="estado" class="form-label">Estado (UF)</label>
                      <select class="form-select" id="estado" name="estado">
                          <option value="" selected disabled>Selecione seu estado</option>
                          <option value="AC">Acre (AC)</option>
                          <option value="AL">Alagoas (AL)</option>
                          <option value="AP">Amapá (AP)</option>
                          <option value="AM">Amazonas (AM)</option>
                          <option value="BA">Bahia (BA)</option>
                          <option value="CE">Ceará (CE)</option>
                          <option value="DF">Distrito Federal (DF)</option>
                          <option value="ES">Espírito Santo (ES)</option>
                          <option value="GO">Goiás (GO)</option>
                          <option value="MA">Maranhão (MA)</option>
                          <option value="MT">Mato Grosso (MT)</option>
                          <option value="MS">Mato Grosso do Sul (MS)</option>
                          <option value="MG">Minas Gerais (MG)</option>
                          <option value="PA">Pará (PA)</option>
                          <option value="PB">Paraíba (PB)</option>
                          <option value="PR">Paraná (PR)</option>
                          <option value="PE">Pernambuco (PE)</option>
                          <option value="PI">Piauí (PI)</option>
                          <option value="RJ">Rio de Janeiro (RJ)</option>
                          <option value="RN">Rio Grande do Norte (RN)</option>
                          <option value="RS">Rio Grande do Sul (RS)</option>
                          <option value="RO">Rondônia (RO)</option>
                          <option value="RR">Roraima (RR)</option>
                          <option value="SC">Santa Catarina (SC)</option>
                          <option value="SP">São Paulo (SP)</option>
                          <option value="SE">Sergipe (SE)</option>
                          <option value="TO">Tocantins (TO)</option>
                      </select>
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="cidade" class="form-label">Cidade</label>
                      <select class="form-select" id="cidade" name="cidade" disabled>
                          <option value="" selected disabled>Selecione primeiro o estado</option>
                      </select>
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="cep" class="form-label">CEP</label>
                      <input type="text" class="form-control" id="cep" name="cep">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="bairro" class="form-label">Bairro</label>
                      <input type="text" class="form-control" id="bairro" name="bairro">
                  </div>
              </div>
          </fieldset>

          <fieldset class="mb-4">
              <legend class="form-section-title">Informações Profissionais</legend>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="formacao" class="form-label">Formação Acadêmica</label>
                      <select class="form-select" id="formacao" name="formacao" required>
                          <option value="" selected disabled>Selecione sua formação...</option>
                          <option value="fundamental_incompleto">Fundamental Incompleto</option>
                          <option value="fundamental_completo">Fundamental Completo</option>
                          <option value="medio_incompleto">Médio Incompleto</option>
                          <option value="medio_completo">Médio Completo</option>
                          <option value="tecnico_incompleto">Técnico Incompleto</option>
                          <option value="tecnico_completo">Técnico Completo</option>
                          <option value="superior_incompleto">Superior Incompleto</option>
                          <option value="tecnologo">Tecnólogo</option>
                          <option value="bacharel">Bacharelado</option>
                          <option value="licenciatura">Licenciatura</option>
                          <option value="especializacao">Especialização</option>
                          <option value="mestrado">Mestrado</option>
                          <option value="doutorado">Doutorado</option>
                      </select>
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="tipo_interesse" class="form-label">Tipo de Interesse</label>
                      <select class="form-select" id="tipo_interesse" name="tipo_interesse">
                          <option value="" selected disabled>Selecione...</option>
                          <option value="clt">CLT</option>
                          <option value="pj">PJ</option>
                          <option value="freelancer">Freelancer</option>
                          <option value="estagio">Estágio</option>
                      </select>
                  </div>
                  <div class="col-md-6 mb-3 equal-height-col">
                      <label class="form-label">Disponibilidade</label>
                      <div class="form-control p-3 equal-height-box">
                          <div class="checkbox-container">
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="segunda" name="disponibilidade[]" value="segunda">
                                  <label class="form-check-label" for="segunda">Segunda-feira</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="terca" name="disponibilidade[]" value="terca">
                                  <label class="form-check-label" for="terca">Terça-feira</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="quarta" name="disponibilidade[]" value="quarta">
                                  <label class="form-check-label" for="quarta">Quarta-feira</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="quinta" name="disponibilidade[]" value="quinta">
                                  <label class="form-check-label" for="quinta">Quinta-feira</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="sexta" name="disponibilidade[]" value="sexta">
                                  <label class="form-check-label" for="sexta">Sexta-feira</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="sabado" name="disponibilidade[]" value="sabado">
                                  <label class="form-check-label" for="sabado">Sábado</label>
                              </div>
                              <div class="form-check">
                                  <input class="form-check-input" type="checkbox" id="domingo" name="disponibilidade[]" value="domingo">
                                  <label class="form-check-label" for="domingo">Domingo</label>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="col-md-6 mb-3 equal-height-col">
                      <label for="experiencia" class="form-label">Experiência Profissional</label>
                      <div class="textarea-container">
                          <textarea class="form-control" id="experiencia" name="experiencia"></textarea>
                      </div>
                  </div>
              </div>
          </fieldset>

          <fieldset class="mb-4">
              <legend class="form-section-title">Dados Bancários</legend>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="banco" class="form-label">Banco</label>
                      <input type="text" class="form-control" id="banco" name="banco">
                  </div>
                  <div class="col-md-3 mb-3">
                      <label for="agencia" class="form-label">Agência</label>
                      <input type="text" class="form-control" id="agencia" name="agencia">
                  </div>
                  <div class="col-md-3 mb-3">
                      <label for="conta" class="form-label">Conta</label>
                      <input type="text" class="form-control" id="conta" name="conta">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="pix" class="form-label">Chave PIX</label>
                      <input type="text" class="form-control" id="pix" name="pix">
                  </div>
              </div>
          </fieldset>

          <fieldset class="mb-4">
              <legend class="form-section-title">Documentos</legend>
              <div class="row">
                  <div class="col-md-6 mb-3">
                      <label for="rg" class="form-label">RG</label>
                      <input type="file" class="form-control" id="rg" name="rg" accept=".pdf,.jpg,.jpeg,.png">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="cpf_doc" class="form-label">CPF</label>
                      <input type="file" class="form-control" id="cpf_doc" name="cpf_doc" accept=".pdf,.jpg,.jpeg,.png">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="titulo_eleitor" class="form-label">Título de Eleitor</label>
                      <input type="file" class="form-control" id="titulo_eleitor" name="titulo_eleitor" accept=".pdf,.jpg,.jpeg,.png">
                  </div>
                  <div class="col-md-6 mb-3">
                      <label for="ctps" class="form-label">CTPS</label>
                      <input type="file" class="form-control" id="ctps" name="ctps" accept=".pdf,.jpg,.jpeg,.png">
                  </div>
              </div>
          </fieldset>

          <div class="text-center mt-4">
            <button type="submit" class="btn" style="background-color: var(--laranja-destaque); color: white;">
              <i class="bi bi-check-circle"></i> Cadastrar Vaga
            </button>
            <a href="{{ url_for('banco_vagas') }}" class="btn btn-secondary">
              <i class="bi bi-x-circle"></i> Cancelar
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  document.getElementById('estado').addEventListener('change', async function() {
      const uf = this.value;
      const cidadeSelect = document.getElementById('cidade');

      cidadeSelect.innerHTML = '<option value="" disabled selected>Carregando cidades...</option>';
      cidadeSelect.disabled = !uf;

      if (!uf) return;

      try {
          const response = await fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${uf}/municipios`);
          const cidades = await response.json();

          cidadeSelect.innerHTML = '<option value="" disabled selected>Selecione sua cidade</option>';

          cidades.forEach(municipio => {
              const option = new Option(municipio.nome, municipio.nome);
              cidadeSelect.add(option);
          });

          cidadeSelect.disabled = false;
      } catch (error) {
          cidadeSelect.innerHTML = '<option value="" disabled selected>Erro ao carregar cidades</option>';
          console.error("Falha ao buscar cidades:", error);
      }
  });
  </script>
</body>
</html>